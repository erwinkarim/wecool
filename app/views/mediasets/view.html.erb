<h2 class="page-header"><%= @mediaset.title %></h2>
<p class="lead"><%= @mediaset.description.nil? ? 'No Description' : @mediaset.description %></p>

<% if persona_signed_in? && current_persona.screen_name == params[:persona_id] then %>
<div class="navbar">
  <div class="navbar-inner">
    <ul class="nav">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Mediaset<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><%= link_to t('.back', :default => t("helpers.links.back")),
               mediaset_path(params[:persona_id])   %></li>
            <li><%= link_to 'Edit', edit_mediaset_path(params[:persona_id], params[:id]) %></li>
            <li class="divider"></li>
            <li><%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              mediaset_path(@mediaset),
              :method => 'delete',
              :data => { :confirm => t('.confirm', 
                :default => t("helpers.links.confirm", :default => 'Are you sure?')) } %></li>
          </ul>
      </li>
    </ul>
  </div>
</div>
<% end %>
<div class="endless-photos" last="<%= @mediaset_photos.last.id %>" >
  <% if  @mediaset_photos.empty? then %>
    <h2>No photos on this set, why don't you 
      <%= link_to 'add some...', edit_mediaset_path(@persona.screen_name, @mediaset) %>
  <% else %>
    <ul class="thumbnails">
      <% @mediaset_photos.each do |photo| %>
        <li><%= link_to image_tag(photo.avatar.small), photo_view_path(@persona.screen_name, photo.id), :class => 'thumbnail' %></li>
      <% end %>
    </ul>
  <% end %>  
  <div class="last-div endless_scroll_inner_wrap"></div>
</div>
<div>
  <p><%= @mediaset.photos.count %> photos</p>
</div>
<script type="text/javascript">
  $(document).ready( function(){
  });

  $(document).endlessScroll({
    fireOnce: true,
    fireDelay: 500, 
    bottomPixels: 250, 
    intervalFrequency: 100, 
    ceaseFireOnEmpty: false, 
    loader: '<div>loading...</div>', 
    callback: function(){
        $.ajax({
          url: '/photos/get_more/'+$('.endless-photos').attr('last'), 
          dataType: 'script', 
          data: { media_type:'mediaset', mediaset_id:'<%= @mediaset.id %>'}
        });
    }, 
    ceaseFire: function(s){
      s<5 ? false : true;
    }
  });
</script>
