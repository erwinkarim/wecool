<%- model_class = Photo -%>
<div class="page-header">
  <h1 id="photo-title"><%= @photo.title == nil ? 'Untitled' : @photo.title %></h1>
  <% if persona_signed_in? && current_persona.id == @persona.id then %>
    <%= form_for @photo, :html => { :id => 'photo-title-form', :class => 'form-horizontal'}  do |f| %>
      <%= f.text_field  :title, :class=> 'span6 input-large' %>
      <%= link_to 'Cancel', '#', :id => 'photo-title-cancel-btn', :class=>'btn' %>
      <%= f.submit 'Update title',:class=>'btn btn-primary' %>
    <% end %>
  <% end %>
</div>

<div class="row-fluid">
  <div class="span9">
    <div class="navbar">
      <!-- menubar for photo -->
      <div class="navbar-inner">
        <ul class="nav">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Photo<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><%= link_to 'Other Versions', photo_version_path(@persona.screen_name, @photo.id) %></li>
                <li><%= link_to 'Launch Editor', photo_editor_path(@photo.id) %></li>
                <li><%= link_to 'Exif Data', photo_view_exif_path(@persona.screen_name, @photo.id) %></li>
                <% if persona_signed_in? && current_persona.id == @persona.id then %>
                <li class="divider"></li>
                <li><%= link_to 'Delete this photo', photo_path(@photo), 
                  :method => 'delete', 
                  :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }
                  %></li>
                <% end %>
              </ul>
          </li>
        </ul>
      </div>
    </div><!-- navbar -->
    <div class="">
      <!-- picture description -->
      <div>
        <%= image_tag @photo.avatar.xlarge %>
      </div>
      <div>
        by <%= link_to @persona.screen_name, persona_path(@persona.screen_name) %>
      </div>
      <div>
        <p id="photo-desc"><%= @photo.description == nil ? 'No Description' : @photo.description %></p>
        <% if persona_signed_in? && current_persona.id == @persona.id then %>
          <%= form_for @photo, :html => { :id => 'photo-desc-form' } do |f| %>
            <%= f.text_area :description, :size => '80x6', :class=>'span9' %> 
            <br />
            <%= link_to 'Cancel', '#photo-desc', :id=>'photo-desc-cancel-btn', :class=>'btn' %>
            <%= f.submit nil, :class=>'btn btn-primary' %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div><!-- span9 -->
    
  <div class="span3">
    <!-- sidebar -->
    <div class="pagination">
      <ul>
        <% if @photo_prev.nil? then %>
          <li><a href="#">First</a></li>
        <% else %>
          <li><%= link_to image_tag(@photo_prev.avatar.square100), 
            photo_view_path(@persona.screen_name, @photo_prev.id) %>
          </li>
        <% end %>
        <% if @photo_next.nil? then %>
          <li><a href="#">Last</a></li>
        <% else %>
          <li><%= link_to image_tag(@photo_next.avatar.square100), 
            photo_view_path(@persona.screen_name, @photo_next.id) %>
          </li>
        <% end %>
      </ul>
    </div>
    <div>
      Belongs to set:-
      <ul>
        <li><%= link_to 'Default', photo_path(@persona.screen_name)  %></li>
        <% @photo.mediasets.each do |mediaset| %>
          <li><%= link_to mediaset.title, view_sets_path(@persona.screen_name, mediaset.id) %></li>
        <% end %>
      </ul>
    </div>
  </div><!-- span3 -->
</div><!-- row -->

<div class="row-fluid">
</div>

<% if persona_signed_in? && @persona.id == current_persona.id then %>
  <div class="row-fluid">
    <div class="span9 form-actions">
      <%= link_to t('.back', :default => t("helpers.links.back")),
                  photo_path(@persona.screen_name), :class => 'btn'  %>
      <%= link_to t('.edit', :default => t("helpers.links.edit")),
                  edit_photo_path(@photo), :class => 'btn' %>
      <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                  photo_path(@photo),
                  :method => 'delete',
                  :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                  :class => 'btn btn-danger' %>
    </div>
  </div>

  <script type="text/javascript">
    $(document).ready(function(){
      //hide all the forms
      $("#photo-title-form").hide();
      $("#photo-desc-form").hide();
      
      //click event
      $("#photo-title").click(function (event){
        $("#photo-title").hide("slow");
        $("#photo-title-form").show("slow");
      });
      $("#photo-title-cancel-btn").click(function (event){
        $("#photo-title").show("slow");
        $("#photo-title-form").hide("slow");
      });
      $("#photo-desc").click(function (event){
        $("#photo-desc").hide("slow");
        $("#photo-desc-form").show("slow"); 
      });
      $("#photo-desc-cancel-btn").click(function (event){
        $("#photo-desc").show("slow");
        $("#photo-desc-form").hide("slow"); 
      });
    });
  </script>

<% end %>
