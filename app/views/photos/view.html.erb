<%- model_class = Photo -%>

<% content_for :title, (@photo.title + ' by ' + @persona.screen_name).html_safe %>
<!-- photo view and description -->
<div class="row-fluid">
  <div class="span12">
    <div class="navbar">
      <!-- menubar for photo -->
      <div class="navbar-inner">
        <ul class="nav">
          <!-- infomation  dropdown menu -->
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Photo<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><%= link_to 'Other Versions', photo_version_path(@persona.screen_name, @photo.id) %></li>
                <li><%= link_to 'Exif Data', photo_view_exif_path(@persona.screen_name, @photo.id) %></li>
                <% if persona_signed_in? && current_persona.id == @persona.id then %>
                  <li><%= link_to 'Add/Remove to Mediaset', '#addToSetModal', :'data-toggle'=>'modal' %></li>
                  <li class="divider"></li>
                  <li><%= link_to '<i class="icon-remove"></i> Delete this photo'.html_safe, photo_path(@photo), 
                    :method => 'delete', 
                    :data => { :confirm => t('.confirm', 
                      :default => t("helpers.links.confirm", :default => 'Are you sure?'))
                    }
                    %></li>
                <% end %>
              </ul>
          </li>
          <!-- end of infomation  dropdown menu -->
          <!-- menu for editing photo, owners only -->
          <% if persona_signed_in? && current_persona.id == @persona.id then %>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="editMenu">Edit<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><%= link_to '<i class="icon-undo"></i> Rotate Counter-Clockwise'.html_safe, 
                  photo_transform_path(@persona.screen_name, @photo.id, 'rotate', :direction => 'left', 
                    :current_version => 'large'), :method => :post, :remote => true %>
                </li>
                <li><%= link_to '<i class="icon-repeat"></i> Rotate Clockwise'.html_safe, 
                  photo_transform_path(@persona.screen_name, @photo.id, 'rotate', :direction => 'right', 
                    :current_version => 'large'), :method => :post, :remote => true %>
                </li>
                <li class="divider"></li>
                <li>
                  <%= link_to '<i class="icon-pencil"></i> Launch Editor'.html_safe, 
                    photo_editor_path(@persona.screen_name, @photo.id) %>
                </li>
              </ul>
            </li>
          <% end %>
          <!-- end menu for editing photo, owners only -->
          <!-- dropdown menu for sharing -->
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Share<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="dropdown-submenu">
                <%= form_tag '#', :style => 'padding:3px 20px;'  do -%>
                  <div class="control-group">
                    <label><i class="icon-link"></i> Copy Link</label>
                    <%= text_field_tag 'PermaAddress', 
                      photo_view_url(@persona.screen_name, @photo), 
                      :disabled => true, :id => 'premaAddress', :class=>'input-xlarge' %> 
                  </div>
                  <div class="control-group">
                    <%= button_tag 'Copy To Clipboard', :type => 'button' , :class => 'btn btn-info',
                      :id => 'copyToClip', :'data-clipboard-target' => 'premaAddress' %>
                  </div>
                <% end -%>
              </li>
              <li class="divider"></li>
              <li>
                <%= form_tag '#', :style => 'padding:3px 20px;' do -%>
                  <div class="control-group">
                      <label><i class="icon-code"></i> Copy HTML</label>
                      <%= text_area_tag 'htmlCopy', 
                        "<div>" + 
                        link_to( 
                          image_tag("#{request.protocol}#{request.host_with_port}" + @photo.avatar.small.url, 
                          :alt => @photo.title
                          ), 
                          photo_view_url(@persona.screen_name, @photo) 
                        ) + 
                        "</div>" + 
                        "\n" + 
                        "<div>" + 
                        link_to( 
                          @photo.title, photo_view_url(@persona.screen_name, @photo) 
                        ) + " by " +
                        link_to(
                          @persona.screen_name, persona_url(@persona.screen_name)
                        ) + " at " +
                        link_to(
                          'WeCool', root_url
                        ) +
                        "</div>", 
                        :id => 'htmlCopyText', :disabled => true, :class=>'input-xlarge', :rows=> 10
                      %>
                  </div>
                  <div class="control-group">
                    <%= label_tag 'Size:' %>
                    <select id="copyHTMLSize">
                      <%= options_for_select( @photo.avatar.versions, @photo.avatar.versions[:small]) %>
                    </select>
                  </div>
                  <div class="control-group">
                    <%= button_tag 'Copy To Clipboard', :type => 'button', :class => 'btn btn-info', 
                      :id => 'copyHTMLToClip', :'data-clipboard-target' => 'htmlCopyText' %>
                  </div>
                <% end -%>  
              </li>
            </ul>
          </li>
          <!-- end of dropdown menu for sharing -->
        </ul>
      </div>
    </div><!-- navbar -->
    <div id="photo" style="margin-bottom:5px;"></div>
    <div id="carousel_<%= @photo.id %>" class="carousel">  
      <!-- picture description -->
      <% if persona_signed_in? && current_persona.id == @persona.id then %>
        <div class="carousel-indicators">
          <%= link_to '<i class="icon-undo icon-2x"></i>'.html_safe, 
            photo_transform_path(@persona.screen_name, @photo.id, 'rotate', :direction => 'left', 
              :current_version => 'large'), :method => :post, :remote => true 
          %>
        </div>
      <% end %>
      <div class="carousel-inner">
        <div class="active item">
          <%= image_tag @photo.avatar.large, 
            :style=> 'margin-left:auto; margin-right:auto;', :id=>'photo_' + @photo.id.to_s %>
          <div class="carousel-caption row-fluid">
            <div class="span7" id="photo-title-and-desc">
              <h4 id="photo-title"><%= @photo.title %>
                <small> by <%= link_to persona_signed_in? && 
                  current_persona == @persona ? 'you' : @persona.screen_name, persona_path(@persona.screen_name) %>
                </small>
              </h4>
              <% if persona_signed_in? && current_persona == @persona then %>
                <%= form_for @photo, :html => { :id=>'photo-title-form', :class=> 'form-horizontal' } do |f| %>
                  <%= f.text_field :title , :class=>'span6'%>
                  <%= link_to 'Cancel', '#', :id=>'photo-title-cancel-btn', :class=>'btn' %> 
                  <%= f.submit 'Update title', :class=>'btn btn-primary' %>
                <% end %>
              <% end %>
              <div id="photo-desc" class="row-fluid" style="max-height:150px; overflow:auto;">
                <%= simple_format(
                  @photo.description.nil? ? 'No Description' : @photo.description, :style=>'padding-bottom:1em;' 
                ) %>
              </div>
              <% if persona_signed_in? && current_persona.id == @persona.id then %>
                <%= form_for @photo, :html => { :id => 'photo-desc-form' } do |f| %>
                  <%= f.text_area :description, :size => '80x6', :class=>'span9', 
                    :placeholder=>'Add description. You can use #hashtag to tag your photos' %> 
                  <br />
                  <%= link_to 'Cancel', '#photo-desc', :id=>'photo-desc-cancel-btn', :class=>'btn' %>
                  <%= f.submit nil, :class=>'btn btn-primary' %>
                <% end %>
              <% end %>
            </div><!-- photo title and description-->
            <div class="span4">
              <div class="progress">
                <!-- the voting & featured stuff -->
                <% total_votes = @photo.up_votes + @photo.down_votes %>
                <% if total_votes == 0 then %>
                  <div class="bar bar-info" style="width:100%;"></div>
                <% else %>
                  <div class="bar bar-success" style="width:<%= @photo.up_votes.to_f/total_votes * 100 %>%;">
                  </div>
                  <div class="bar bar-danger" style="width:<%= @photo.down_votes.to_f/total_votes * 100 %>%;">
                  </div>
                <% end %>
              </div><!-- progress -->
              <div class="pull-left">
                <h4><div id="totalVoteBox"><%= pluralize total_votes, 'vote' %></div></h4>
              </div>
              <div id="ToVoteAndFeatureBox" class="pull-right">
                <div class="pull-left">
                  <h4>
                    <div id="visibilityBox" style="margin-right:1em;">
                      <a name="visibilityAnchor"></a>
                      <% if current_persona == @persona  && current_persona.premium then %>
                        <% visibilityIcon = ('<i class="icon-eye-' + (@photo.visible? ? 'open' : 'close') + 
                          '"></i>').html_safe %>
                        <% if @photo.featured then %>
                          <%= link_to visibilityIcon, '#photo', :'data-toggle'=> 'popover', 
                            :'data-placement' => 'top', :'data-content' => 'Featured photos is always visible', 
                            :'data-original-title' => 'Notice' %>
                        <% else %>
                          <%= link_to visibilityIcon, photo_toggle_visibility_path(@persona.screen_name, @photo), 
                            :remote => true, :method => :post
                          %>
                        <% end %>
                      <% end %>
                    </div>
                  </h4>
                </div>
                <div>
                  <h4>
                    <div id="featuredBox">
                      <% if current_persona == @persona then %>
                        <% theStar = @photo.featured ? 'icon-star' : 'icon-star-empty' %>
                        <%= link_to ('<i class="isFeatured '+ theStar +'"></i>').html_safe, 
                          photo_toggle_featured_path(@persona.screen_name, @photo), :remote=>true, :method=>:post
                         %>
                      <% end %>
                    </div>
                  </h4>
                </div>
                <div>
                  <h4>
                    <div class="voteBox">
                    <% if persona_signed_in? then %>
                      <% if current_persona.voted?(@photo) then %>
                        Voted <i class="icon-thumbs-<%= current_persona.up_voted?(@photo) ? 'up' : 'down' %>"></i> - 
                        <%= link_to 'unvote', photo_unvote_path(@photo,current_persona.screen_name), 
                          :remote => true, :method => :post %>
                      <% else %>
                        <%= link_to '<i class="icon-thumbs-up"></i>'.html_safe, 
                          photo_vote_path(@photo, 'up', current_persona.screen_name), 
                          :remote=>true, :method => :post %>
                        <%= link_to '<i class="icon-thumbs-down"></i>'.html_safe, 
                          photo_vote_path(@photo, 'down', current_persona.screen_name), 
                          :remote=>true, :method=>:post %>
                      <% end %>
                    <% else %>
                      <p>Login to Vote</p>
                    <% end %>
                    </div>
                    </h4>
                  </div>
                </div>
              </div>
            </div><!-- carousel-caption -->
          </div><!-- active item -->
        </div><!-- corousel-inner -->
        <%= link_to '&lsaquo;'.html_safe, @prev_photo_path, :class=>'carousel-control left' %>
        <%= link_to '&rsaquo;'.html_safe, @next_photo_path, :class=>'carousel-control right' %>
      </div><!--carousel-->
  </div><!-- span12 -->
</div><!-- row -->

<!-- photo-gallery -->
<div class="accordion" id="accordion2">
  <div class="accordion-group">
      <!-- show which mediasets this photo belongs to -->
    <div class="accordion-heading">
      <h3>
        <%= link_to '<i class="icon-chevron-down"></i>'.html_safe, '#collapseDefault', 
          :class=>'accordion-toggle', :'data-toggle'=>'collapse', :'data-parent'=>"#accordion2", 
          :style=>'display:inline;'  %><%= link_to 'Photos by '+@persona.screen_name, 
            photo_path(@persona.screen_name, :view=>'raw') %>
      </h3>
    </div>
    <div class="accordion-body collapse <%= params[:scope].nil? ? 'in' : '' %>" id="collapseDefault">
      <div class="accordion-inner">
        <div class="row-fluid">
          <%= button_tag 'Load Newer', 
            { :class => 'btn btn-mini btn-info', :role => 'button', :id => 'loadPrevPhotosBtn' } %>
        </div>
        <div id="photostream" class="row-fluid" first="<%= @photo.id %>" last="<%= @photo.id %>">
        </div>
        <div class="row-fluid">
          <%= button_tag 'Load Older', 
            { :class => 'btn btn-mini btn-info', :role => 'button', :id => 'loadMorePhotosBtn' } %>
        </div>
      </div>
    </div>
  </div>
  <% if @photo.featured then %>
    <div class="accordion-group">
      <div class="accordion-heading">
        <h3>
          <%= link_to '<i class="icon-chevron-down"></i>'.html_safe, '#collapsedFeatured', 
            :class=>'accordion-toggle', :'data-toggle'=>'collapse', :'data-parent'=>"#accordion2", 
            :style=>'display:inline;'  %><%= link_to 'Featured photos by '+@persona.screen_name, 
              photo_path(@persona.screen_name, :view=>'raw') %>
        </h3>
      </div>
      <div class="accordion-body collapse <%= params[:scope] == 'featured' ? 'in' : '' %>" id="collapsedFeatured">
        <div class="accordion-inner">
            <div class="row-fluid">
              <%= button_tag 'Load Newer', 
                { :class => 'btn btn-mini btn-info', :role => 'button', :id => 'loadNewerFeaturedBtn' } %>
            </div>
            <div id="featuredPhotos" class="row-fluid" first="<%= @photo.id %>" last="<%= @photo.id %>" >
            </div>
            <div class="row-fluid">
              <%= button_tag 'Load Older', 
                { :class => 'btn btn-mini btn-info', :role => 'button', :id => 'loadOlderFeaturedBtn' } %>
            </div>
        </div>
      </div>
    </div>
  <% end %>
  <% @photo.mediasets.each do |mediaset| %>
    <div class="accordion-group">  
      <div class="accordion-heading">
        <h3>
        <%= link_to '<i class="icon-chevron-down"></i>'.html_safe, '#collapse'+mediaset.id.to_s, 
          :class=>'accordion-toggle', :'data-toggle'=>'collapse', :'data-parent'=>'#accordion2', 
          :style=>'display:inline;' %><%= link_to mediaset.title, view_sets_path(@persona.screen_name, mediaset) %>
        </h3>
      </div>
      <div class="accordion-body collapse <%= @current_mediaset == mediaset ? 'in' : '' %>" id="collapse<%= mediaset.id %>">
        <div class="accordion-inner">
          <div class="row-fluid">
            <%= button_tag 'Load Newer', 
              { :class => 'btn btn-mini btn-info', :role => 'button', 
                :id => 'loadNewerMediaset-' + mediaset.id.to_s + '-btn' } %>
          </div>
          <% photo_order = @photo.mediaset_photos.where( :mediaset_id => mediaset).pluck('"order"').first %>
          <div class="row-fluid" id="mediaset-<%= mediaset.id %>" 
            first="<%= photo_order %>" last="<%= photo_order %>" >
          </div>
          <div class="row-fluid">
            <%= button_tag 'Load Older', 
              { :class => 'btn btn-mini btn-info', :role => 'button', 
                :id => 'loadOlderMediaset-' + mediaset.id.to_s + '-btn' } %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <!-- tag related photos -->
  <% if !@related_photos.first.nil? then %>
    <div class="accordion-group">  
      <div class="accordion-heading">
        <h3>
        <%= link_to '<i class="icon-chevron-down"></i>'.html_safe, '#collapse_related',
          :class=>'accordion-toggle', :'data-toggle'=>'collapse', :'data-parent'=>'#accordion2', 
          :style=>'display:inline;' %><%= link_to 'Related Photos', tag_related_path(@photo) %>
        </h3>
      </div>
      <div class="accordion-body collapse" id="collapse_related">
        <div class="accordion-inner">
          <div class="row-fluid" id="related-photos" last="0">
          </div>
          <div class="row-fluid">
            <%= button_tag 'Load More', 
              { :class => 'btn btn-mini btn-info', :role => 'button', :id => 'loadMoreRelatedBtn' } %>
          </div>
        </div>
      
      </div>
    </div>
  <% end %>
</div>


<!-- modal for updating mediaset selection -->
<%= render :template => "photos/updateMediasetModal", :locals => { :photo => @photo }  %>

<% if persona_signed_in? && @persona.id == current_persona.id then %>
  <script type="text/javascript">
    //for owners of the photo
    $(document).ready(function(){
      //hide all the forms
      $("#photo-title-form").hide();
      $("#photo-desc-form").hide();
      
      //click event
      $("#photo-title").click(function (event){
        $("#photo-title").hide("slow");
        $("#photo-title-form").show("slow");
      });
      $("#photo-title-cancel-btn").click(function (event){
        $("#photo-title").show("slow");
        $("#photo-title-form").hide("slow");
      });
      $("#photo-desc").click(function (event){
        $("#photo-desc").hide("slow");
        $("#photo-desc-form").show("slow"); 
      });
      $("#photo-desc-cancel-btn").click(function (event){
        $("#photo-desc").show("slow");
        $("#photo-desc-form").hide("slow"); 
      });
    });
  </script>
<% end %>
<script type="text/javascript">

  //load normal photos
  $.ajax({
    url: '/photos/get_more/<%= @photo.id %>',
    data: { size:'square100', showCaption:false, targetDiv:'#photostream', photoCountDiv:'#photostream', 
      includeFirst:true, author:'<%= @persona.screen_name %>', showIndicators:false, highlight:true, limit:4 ,
      photoFocusID:<%= @photo.id %>},
    dataType: 'script'
  });
  $.ajax({
    url: '/photos/get_more/<%= @photo.id %>',
    data: { size:'square100', showCaption:false, targetDiv:'#photostream', photoCountDiv:'#photostream', 
      author:'<%= @persona.screen_name %>', showIndicators:false, highlight:true, limit:3, direction:'reverse' },
    dataType: 'script'
  });


  <% if @photo.featured? then %>
    //load featured photos
    $.ajax({
      url: '/photos/get_more/<%= @photo.id %>',
      data: { size:'square100', showCaption:false, targetDiv:'#featuredPhotos', photoCountDiv:'#featuredPhotos', 
        featured:true, includeFirst:true, author:'<%= @persona.screen_name %>', 
        mediatype:'featured', showIndicators:false, highlight:true, limit:4, photoFocusID:<%= @photo.id %> },
      dataType: 'script'
    });
    $.ajax({
      url: '/photos/get_more/<%= @photo.id %>',
      data: { size:'square100', showCaption:false, targetDiv:'#featuredPhotos', photoCountDiv:'#featuredPhotos', 
        featured:true, author:'<%= @persona.screen_name %>', mediatype:'featured', showIndicators:false, 
        highlight:true, direction:'reverse', limit:3 },
      dataType: 'script'
    });
  <% end %>

  //load each mediaset
  <% @photo.mediasets.each do |mediaset| %>
    //load mediaset photos
    $.ajax({
      url: '/photos/get_more/' + $('#mediaset-<%= mediaset.id %>').attr('last') ,
      data: { size:'square100', showCaption:false, targetDiv:'#mediaset-<%= mediaset.id %>', 
        photoCountDiv:'#mediaset-<%= mediaset.id %>', mediaset_id:<%= mediaset.id %>,  
        includeFirst:true, mediatype:'mediaset', showIndicators:false, highlight:true, limit:3, 
        photoFocusID:<%= @photo.id %>},
      dataType: 'script'
    });
    $.ajax({
      url: '/photos/get_more/' + $('#mediaset-<%= mediaset.id %>').attr('last') ,
      data: { size:'square100', showCaption:false, targetDiv:'#mediaset-<%= mediaset.id %>', 
        photoCountDiv:'#mediaset-<%= mediaset.id %>', mediaset_id:<%= mediaset.id %>,  
        mediatype:'mediaset', showIndicators:false, highlight:true, limit:3, direction:'reverse' },
      dataType: 'script'
    });
  <% end %>

  //load related photos
  $.ajax({
      url: '/photos/get_more/0',
      data: { size:'square100', showCaption:false, targetDiv:'#related-photos', 
        photoCountDiv:'#related-photos', mediatype:'related', showIndicators:false, limit:7,
        focusPhotoID:<%= @photo.id %> },
      dataType: 'script'
  });
  //for normal users 
  $(document).ready(function(){
      //hide the caption and control, appear on mouse hover
      $('.carousel-caption').hide();
      $('.carousel-control').hide();
      $('.carousel-indicators').hide();
      $('.carousel').hover(
        function(){ 
          $('.carousel-caption').fadeIn('slow');
          $('.carousel-control').fadeIn('slow');
          $('.carousel-indicators').fadeIn('slow');
        }, function(){ 
          $('.carousel-caption').fadeOut('slow');
          $('.carousel-control').fadeOut('slow');
          $('.carousel-indicators').fadeOut('slow');
        }
      );

      if( $('.isFeatured').hasClass('icon-star') ){
        $('#visibilityBox').find('a').popover();
      }

      $('#loadPrevPhotosBtn').click( function(){
        //load more
        $.ajax({
          url: '/photos/get_more/' + $('#photostream').attr('first'), 
          data: { size:'square100', showCaption:false, targetDiv:'#photostream', photoCountDiv:'#photostream', 
            author:'<%= @persona.screen_name %>', showIndicators:false, direction:'reverse' },
          dataType: 'script'
        });
      });

      $('#loadMorePhotosBtn').click( function(){
        //load more
        $.ajax({
          url: '/photos/get_more/' + $('#photostream').attr('last'), 
          data: { size:'square100', showCaption:false, targetDiv:'#photostream', photoCountDiv:'#photostream', 
            author:'<%= @persona.screen_name %>', showIndicators:false},
          dataType: 'script'
        });
      });

      $('#loadNewerFeaturedBtn').click( function(){
        $.ajax({
          url: '/photos/get_more/' + $('#featuredPhotos').attr('first'), 
          data: { size:'square100', showCaption:false, targetDiv:'#featuredPhotos', photoCountDiv:'#featuredPhotos', 
            featured:true, author:'<%= @persona.screen_name %>', 
            mediatype:'featured', showIndicators:false, direction:'reverse' },
          dataType: 'script'
        });
      });

      $('#loadOlderFeaturedBtn').click( function(){
        //load more
        $.ajax({
          url: '/photos/get_more/' + $('#featuredPhotos').attr('last'), 
          data: { size:'square100', showCaption:false, targetDiv:'#featuredPhotos', photoCountDiv:'#featuredPhotos', 
            featured:true, author:'<%= @persona.screen_name %>', 
            mediatype:'featured', showIndicators:false },
          dataType: 'script'
        });
      });

      <% @photo.mediasets.each do |mediaset| %>
        $('#loadNewerMediaset-<%= mediaset.id %>-btn').click( function(){
          $.ajax({
            url: '/photos/get_more/' + $('#mediaset-<%= mediaset.id %>').attr('first') ,
            data: { size:'square100', showCaption:false, targetDiv:'#mediaset-<%= mediaset.id %>', 
              photoCountDiv:'#mediaset-<%= mediaset.id %>', mediaset_id:<%= mediaset.id %>,  
              mediatype:'mediaset', showIndicators:false, direction:'reverse' },
            dataType: 'script'
          });

        });

        $('#loadOlderMediaset-<%= mediaset.id %>-btn').click( function(){
          $.ajax({
            url: '/photos/get_more/' + $('#mediaset-<%= mediaset.id %>').attr('last') ,
            data: { size:'square100', showCaption:false, targetDiv:'#mediaset-<%= mediaset.id %>', 
              photoCountDiv:'#mediaset-<%= mediaset.id %>', mediaset_id:<%= mediaset.id %>,  
              mediatype:'mediaset', showIndicators:false },
            dataType: 'script'

          });
        });
      <% end %>

      $('#loadMoreRelatedBtn').click( function(){
        $.ajax({
            url: '/photos/get_more/' + $('#related-photos').attr('last'),
            data: { size:'square100', showCaption:false, targetDiv:'#related-photos', 
              photoCountDiv:'#related-photos', mediatype:'related', showIndicators:false, limit:7,
              focusPhotoID:<%= @photo.id %> },
            dataType: 'script'
        });
      })

      //for the link copy copy to clipboard
      var clip = new ZeroClipboard( document.getElementById('copyToClip'), {
        moviePath: '/assets/ZeroClipboard.swf'
      });
    
      clip.on('complete', function(client, args){
        alert('Copied to Clipboard');
      });

      // for the html Code Copy to clipboard
      var htmlClip = new ZeroClipboard( document.getElementById('copyHTMLToClip'), {
        moviePath: '/assets/ZeroClipboard.swf'
      });

      htmlClip.on('complete', function(client, args){
        alert('Copied to Clipboard');
      });

      $('#copyHTMLSize').change( function(){
        //update text area
        var tempText = $('#htmlCopyText').val();
        tempText = tempText.replace(/src=".*"/, 
          "src=\"<%= "#{request.protocol}#{request.host_with_port}" %>" + $("#copyHTMLSize").val() + "\"" ); 
        $('#htmlCopyText').val(tempText);
      });

  }); //$(document).ready(){}

  $(document).keydown(function (e) {
    var keyCode = e.keyCode || e.which,
        arrow = {left: 37, up: 38, right: 39, down: 40 };

    switch (keyCode) {
      case arrow.left:
        $(location).attr('href', "<%= @prev_photo_path %>");
      break;
      case arrow.right:
        $(location).attr('href', "<%= @next_photo_path %>");
      break;
    }
  });
</script>
