<% @focus = 'Followers and Following' %>
<%= render "common/personaHeaderBar" %>

<div class="row-fluid">
  <h1>Following</h1>
  <div class="row-fluid" id="following-personas" last="<%= Persona.last.id %>" >
  </div>
  <br />
  <div class="row-fluid">
    <a name="following-persona-last-div"></a>
    <%= link_to 'Load More...', '#following-persona-last-div', :class=> 'btn', :id=>'load-more-following' %>
  </div>
</div>

<div class="row-fluid">
  <h1>Followers</h1>
  <div class="row-fluid" id="being-tracked-personas" last="<%= Persona.last.id %>" >
  </div>
  <br />
  <div class="row-fluid">
    <a name="tracked-persona-last-div"></a>
    <%= link_to 'Load More...', '#tracked-persona-last-div', :class=> 'btn', :id=>'load-more-followers' %>
  </div>
</div>
<script type="text/javascript">
  //load a few for each class
  $.ajax({
    url: '/personas/get_more/<%= Persona.last.id %>',
    data: { includeFirst:true, handle:'#following-personas', fetch_mode:'following', fetch_focus_id:'<%= @persona.id %>' },
    dataType: 'script'
  });
  
  $.ajax({
    url: '/personas/get_more/<%= Persona.last.id %>',
    data: { includeFirst:true, handle:'#being-tracked-personas', fetch_mode:'followers', fetch_focus_id:'<%= @persona.id %>' },
    dataType: 'script'
  });
  
  $(document).ready( function(){
    //load on click
    $('#load-more-following').click( function(){
      $.ajax({
        url: '/personas/get_more/' + $('#following-personas').attr('last') , 
        data: { includeFirst:false, handle:'#following-personas', fetch_mode:'following', fetch_focus_id:'<%= @persona.id %>' },
        dataType: 'script'
      });
    });

    $('#load-more-followers').click( function(){
      $.ajax({
        url: '/personas/get_more/'+$('#being-tracked-personas').attr('last'),
        data: { includeFirst:false, handle:'#being-tracked-personas', fetch_mode:'followers', fetch_focus_id:'<%= @persona.id %>' },
        dataType: 'script'
      });

    });
  });
</script>
